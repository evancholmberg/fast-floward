{"ast":null,"code":"var _jsxFileName = \"/home/evan/Documents/flow/fast-floward/quests/week1/day5/Artist/src/pages/Trade/Trade.jsx\",\n    _s = $RefreshSig$();\n\nimport { useContext, useReducer, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport classNames from 'classnames';\nimport Pixel from '../../model/Pixel.js';\nimport Picture from '../../model/Picture.js';\nimport FlowContext from '../../context/Flow.jsx';\nimport Frame from '../Draw/Frame.jsx';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst constants = {\n  flowFormat: new Intl.NumberFormat('en-US', {\n    minimumFractionDigits: 4\n  })\n};\n\nfunction reducer(state, action) {\n  switch (action.type) {\n    case 'setListings':\n      {\n        return { ...state,\n          listings: action.payload.map(listing => ({ ...listing,\n            picture: new Picture(listing.canvas.pixels, listing.canvas.width, listing.canvas.height),\n            price: Number.parseFloat(listing.price)\n          }))\n        };\n      }\n\n    case 'startProcessing':\n      {\n        return { ...state,\n          processingListingIndex: action.payload\n        };\n      }\n\n    case 'stopProcessing':\n      {\n        return { ...state,\n          processingListingIndex: null\n        };\n      }\n\n    default:\n      return state;\n  }\n}\n\nfunction Trade(props) {\n  _s();\n\n  const flow = useContext(FlowContext);\n  const [state, dispatch] = useReducer(reducer, {\n    listings: null,\n    processingListingIndex: null\n  });\n  useEffect(() => {\n    flow.fetchListings().then(listings => dispatch({\n      type: 'setListings',\n      payload: listings\n    }));\n  }, [flow]);\n\n  const onBuy = async listingIndex => {\n    console.log(listingIndex);\n    dispatch({\n      type: 'startProcessing',\n      payload: listingIndex\n    }); // Once your buy() method is implemented in Flow.jsx, uncomment this line.\n\n    await flow.buy(listingIndex);\n    await flow.fetchCollection();\n    const listings = await flow.fetchListings();\n    await flow.fetchBalance();\n    dispatch({\n      type: 'setListings',\n      payload: listings\n    });\n    dispatch({\n      type: 'stopProcessing'\n    });\n  };\n\n  const onWithdraw = async listingIndex => {\n    console.log(listingIndex);\n    dispatch({\n      type: 'startProcessing',\n      payload: listingIndex\n    }); // Once your withdrawListing() method is implemented in Flow.jsx, uncomment this line.\n\n    await flow.withdrawListing(listingIndex);\n    await flow.fetchCollection();\n    await flow.fetchBalance();\n    const listings = await flow.fetchListings();\n    dispatch({\n      type: 'setListings',\n      payload: listings\n    });\n    dispatch({\n      type: 'stopProcessing'\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n      className: \"title is-5\",\n      children: \"Buy and Sell Pictures\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"table\", {\n      className: \"table is-fullwidth is-striped is-narrow\",\n      children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n        children: /*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Picture\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 90,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Seller\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 91,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            className: \"is-justify-content-flex-end has-text-right\",\n            children: \"Price\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 92,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n        children: state.listings && state.listings.map((listing, index) => {\n          const isUserOwner = flow.state.user.addr === listing.seller;\n          return /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"td\", {\n              children: /*#__PURE__*/_jsxDEV(Frame, {\n                pixel: Pixel.thumbnail,\n                picture: listing.picture\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 103,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 102,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: listing.seller\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 108,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              className: \"is-justify-content-end\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"tags has-addons are-medium is-justify-content-flex-end\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"tag is-primary is-light\",\n                  children: \"FLOW\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 113,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"tag\",\n                  children: constants.flowFormat.format(listing.price)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 114,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 112,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 111,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: [!isUserOwner && /*#__PURE__*/_jsxDEV(\"button\", {\n                className: classNames({\n                  'button is-success': true,\n                  'is-loading': state.processingListingIndex === index\n                }),\n                onClick: () => onBuy(index),\n                children: \"Buy\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 121,\n                columnNumber: 21\n              }, this), isUserOwner && /*#__PURE__*/_jsxDEV(\"button\", {\n                className: classNames({\n                  'button is-warning': true,\n                  'is-loading': state.processingListingIndex === index\n                }),\n                onClick: () => onWithdraw(index),\n                children: \"Withdraw\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 132,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 119,\n              columnNumber: 17\n            }, this)]\n          }, listing.picture.pixels, true, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 15\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 85,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Trade, \"2Mqri5oN6v+JENxGWZOIPY8y6tw=\");\n\n_c = Trade;\nexport default Trade;\n\nvar _c;\n\n$RefreshReg$(_c, \"Trade\");","map":{"version":3,"sources":["/home/evan/Documents/flow/fast-floward/quests/week1/day5/Artist/src/pages/Trade/Trade.jsx"],"names":["useContext","useReducer","useEffect","Link","classNames","Pixel","Picture","FlowContext","Frame","constants","flowFormat","Intl","NumberFormat","minimumFractionDigits","reducer","state","action","type","listings","payload","map","listing","picture","canvas","pixels","width","height","price","Number","parseFloat","processingListingIndex","Trade","props","flow","dispatch","fetchListings","then","onBuy","listingIndex","console","log","buy","fetchCollection","fetchBalance","onWithdraw","withdrawListing","index","isUserOwner","user","addr","seller","thumbnail","format"],"mappings":"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","sourcesContent":["import {useContext, useReducer, useEffect} from 'react';\n\nimport {Link} from 'react-router-dom';\nimport classNames from 'classnames';\n\nimport Pixel from '../../model/Pixel.js';\nimport Picture from '../../model/Picture.js';\n\nimport FlowContext from '../../context/Flow.jsx';\n\nimport Frame from '../Draw/Frame.jsx';\n\nconst constants = {\n  flowFormat: new Intl.NumberFormat('en-US', {\n    minimumFractionDigits: 4\n  })\n};\n\nfunction reducer(state, action) {\n  switch (action.type) {\n    case 'setListings': {\n      return {\n        ...state,\n        listings: action.payload.map((listing) => ({\n          ...listing,\n          picture: new Picture(listing.canvas.pixels, listing.canvas.width, listing.canvas.height),\n          price: Number.parseFloat(listing.price)\n        }))\n      };\n    }\n    case 'startProcessing': {\n      return {\n        ...state,\n        processingListingIndex: action.payload\n      };\n    }\n    case 'stopProcessing': {\n      return {\n        ...state,\n        processingListingIndex: null\n      };\n    }\n    default:\n      return state;\n  }\n}\n\nfunction Trade(props) {\n  const flow = useContext(FlowContext);\n  const [state, dispatch] = useReducer(reducer, {\n    listings: null,\n    processingListingIndex: null\n  });\n\n  useEffect(() => {\n    flow\n      .fetchListings()\n      .then((listings) => dispatch({type: 'setListings', payload: listings}));\n  }, [flow]);\n\n  const onBuy = async (listingIndex) => {\n    console.log(listingIndex);\n    dispatch({type: 'startProcessing', payload: listingIndex});\n    // Once your buy() method is implemented in Flow.jsx, uncomment this line.\n    await flow.buy(listingIndex);\n    await flow.fetchCollection()\n    const listings = await flow.fetchListings();\n    await flow.fetchBalance();\n    dispatch({type: 'setListings', payload: listings});\n    dispatch({type: 'stopProcessing'});\n  };\n  const onWithdraw = async (listingIndex) => {\n    console.log(listingIndex);\n    dispatch({type: 'startProcessing', payload: listingIndex});\n    // Once your withdrawListing() method is implemented in Flow.jsx, uncomment this line.\n    await flow.withdrawListing(listingIndex);\n    await flow.fetchCollection();\n    await flow.fetchBalance();\n    const listings = await flow.fetchListings();\n    dispatch({type: 'setListings', payload: listings});\n    dispatch({type: 'stopProcessing'});\n  };\n\n  return (\n    <div>\n      <h5 className=\"title is-5\">Buy and Sell Pictures</h5>\n      <table className=\"table is-fullwidth is-striped is-narrow\">\n        <thead>\n          <tr>\n            <th>Picture</th>\n            <th>Seller</th>\n            <th className=\"is-justify-content-flex-end has-text-right\">Price</th>\n            <th></th>\n          </tr>\n        </thead>\n        <tbody>\n          {state.listings && state.listings.map((listing, index) => {\n            const isUserOwner = flow.state.user.addr === listing.seller;\n\n            return (\n              <tr key={listing.picture.pixels}>\n                <td>\n                  <Frame\n                    pixel={Pixel.thumbnail}\n                    picture={listing.picture}\n                  />\n                </td>\n                <td>\n                  {listing.seller}\n                </td>\n                <td className=\"is-justify-content-end\">\n                  <div className=\"tags has-addons are-medium is-justify-content-flex-end\">\n                    <span className=\"tag is-primary is-light\">FLOW</span>\n                    <span className=\"tag\">\n                      {constants.flowFormat.format(listing.price)}\n                    </span>\n                  </div>\n                </td>\n                <td>\n                  {!isUserOwner &&\n                    <button\n                      className={classNames({\n                        'button is-success': true,\n                        'is-loading': state.processingListingIndex === index\n                      })}\n                      onClick={() => onBuy(index)}\n                    >\n                      Buy\n                    </button>\n                  }\n                  {isUserOwner &&\n                    <button\n                      className={classNames({\n                        'button is-warning': true,\n                        'is-loading': state.processingListingIndex === index\n                      })}\n                      onClick={() => onWithdraw(index)}\n                    >\n                      Withdraw\n                    </button>\n                  }\n                </td>\n              </tr>\n            );\n          })}\n        </tbody>\n      </table>\n    </div>\n  );\n}\n\nexport default Trade;"]},"metadata":{},"sourceType":"module"}